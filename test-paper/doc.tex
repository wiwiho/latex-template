\documentclass[12pt]{article}
\usepackage{xeCJK}
\usepackage{fontspec}
\usepackage[a4paper,top=1.5cm,bottom=2cm,left=1.5cm,right=1.5cm]{geometry}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{indentfirst}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{tabularx}
\usepackage{hyperref}
\usepackage{ulem}
\usepackage{version}
\usepackage{thmtools}
\usepackage{qtree}
\usepackage{algpseudocode}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage[shortlabels]{enumitem}
\usepackage{ctable}
\usepackage{totcount}
\usepackage{makecell}

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt

\setCJKmainfont[AutoFakeBold,AutoFakeSlant]{Noto Serif CJK TC}
% \setmonofont{Consolas}
\newfontfamily{\TestTitleMainFont}{NotoSerifCJK-Bold.ttc}
\newCJKfontfamily{\TestTitleCJKFont}{NotoSansCJK-Bold.ttc}
\newcommand{\TestTitleFont}{\TestTitleMainFont\TestTitleCJKFont}

\pagestyle{fancy}

\lstset{
    language=C,
    basicstyle=\footnotesize\ttfamily,
    breaklines=true,
    % numberstyle=\footnotesize\ttfamily,
    % numbers=left,
    % numbersep=1pt,
    % stepnumber=1,
    breakatwhitespace=false,
    escapeinside={\%*}{*)},
    morekeywords={*},
    literate={\ \ }{{\ }}1,
    aboveskip=0.2cm,
    belowskip=0cm
}

\newcommand{\TestTitle}[1]{
    \begin{center}
        \TestTitleFont\LARGE{#1}
    \end{center}
}
\newcommand{\TestSection}[1]{\par\noindent{\TestTitleFont #1}\normalsize\par}

\newenvironment{TestProblem}{
    \item
}{}

\newcommand{\TestOptionQuarter}[4]{
    \hspace{-0.28cm}
    \begin{tabular}{p{0.2\linewidth}p{0.2\linewidth}p{0.2\linewidth}p{0.2\linewidth}}
        (A) #1 & (B) #2 & (C) #3 & (D) #4
    \end{tabular}
}
\newcommand{\TestOptionHalf}[4]{
    \hspace{-0.28cm}
    \begin{tabular}{p{0.4\linewidth}p{0.4\linewidth}}
        (A) #1 & (B) #2 \\
        (C) #3 & (D) #4
    \end{tabular}
}
\newcommand{\TestOptionOne}[4]{
    \begin{enumerate}[(A)]
        \item #1
        \item #2
        \item #3
        \item #4
    \end{enumerate}
}

\newcommand{\TestBlank}[1]{\texttt{\_\_(#1)\_\_}}

\setlist[enumerate]{itemsep=0pt, parsep=0pt, topsep=0pt, leftmargin=*}
\setlist[itemize]{itemsep=0pt, parsep=0pt, topsep=0pt, leftmargin=*}

\raggedcolumns

\begin{document}

\renewcommand{\headrulewidth}{0pt}
\renewcommand{\baselinestretch}{1.1}
\pagenumbering{arabic}
\setlength\parindent{0pt}
\setlength\parskip{12pt}
\cfoot{\thepage}

\TestTitle{110 學年度~師大附中資訊學科能力競賽~筆試}

＊題目中的程式碼皆以 C11 為標準

\TestSection{單選題（共 25 題，一題 4 分，總分 100 分）}

\begin{enumerate}
    \input{p1.tex}
    \input{p2.tex}
    \input{p3.tex}
    \clearpage
    \input{p4.tex}
\end{enumerate}

\input{sieve.tex}

\end{document}